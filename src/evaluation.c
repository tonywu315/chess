#include "evaluation.h"

/* Pieces values from simplified evaluation function */
static const int value[7] = {0, 100, 320, 330, 500, 900, 20000};
static const int position[7][128] = {
    {0},
    {
        0,  0,  0,   0,   0,   0,   0,  0,  0, 0, 0, 0, 0, 0, 0, 0,
        5,  10, 10,  -20, -20, 10,  10, 5,  0, 0, 0, 0, 0, 0, 0, 0,
        5,  -5, -10, 0,   0,   -10, -5, 5,  0, 0, 0, 0, 0, 0, 0, 0,
        0,  0,  0,   20,  20,  0,   0,  0,  0, 0, 0, 0, 0, 0, 0, 0,
        5,  5,  10,  25,  25,  10,  5,  5,  0, 0, 0, 0, 0, 0, 0, 0,
        10, 10, 20,  30,  30,  20,  10, 10, 0, 0, 0, 0, 0, 0, 0, 0,
        50, 50, 50,  50,  50,  50,  50, 50, 0, 0, 0, 0, 0, 0, 0, 0,
        0,  0,  0,   0,   0,   0,   0,  0,  0, 0, 0, 0, 0, 0, 0, 0,
    },
    {
        -50, -40, -30, -30, -30, -30, -40, -50, 0, 0, 0, 0, 0, 0, 0, 0,
        -40, -20, 0,   5,   5,   0,   -20, -40, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, 5,   10,  15,  15,  10,  5,   -30, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, 0,   15,  20,  20,  15,  0,   -30, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, 5,   15,  20,  20,  15,  5,   -30, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, 0,   10,  15,  15,  10,  0,   -30, 0, 0, 0, 0, 0, 0, 0, 0,
        -40, -20, 0,   0,   0,   0,   -20, -40, 0, 0, 0, 0, 0, 0, 0, 0,
        -50, -40, -30, -30, -30, -30, -40, -50, 0, 0, 0, 0, 0, 0, 0, 0,
    },
    {
        -20, -10, -10, -10, -10, -10, -10, -20, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 5,   0,   0,   0,   0,   5,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 10,  10,  10,  10,  10,  10,  -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 0,   10,  10,  10,  10,  0,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 5,   5,   10,  10,  5,   5,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 0,   5,   10,  10,  5,   0,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 0,   0,   0,   0,   0,   0,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -20, -10, -10, -10, -10, -10, -10, -20, 0, 0, 0, 0, 0, 0, 0, 0,
    },
    {
        0, 0,  0,  5,  5,  0,  0,  0,  0, 0, 0,  0,  0, 0,  0,  0, -5, 0,  0,
        0, 0,  0,  0,  -5, 0,  0,  0,  0, 0, 0,  0,  0, -5, 0,  0, 0,  0,  0,
        0, -5, 0,  0,  0,  0,  0,  0,  0, 0, -5, 0,  0, 0,  0,  0, 0,  -5, 0,
        0, 0,  0,  0,  0,  0,  0,  -5, 0, 0, 0,  0,  0, 0,  -5, 0, 0,  0,  0,
        0, 0,  0,  0,  -5, 0,  0,  0,  0, 0, 0,  -5, 0, 0,  0,  0, 0,  0,  0,
        0, 5,  10, 10, 10, 10, 10, 10, 5, 0, 0,  0,  0, 0,  0,  0, 0,  0,  0,
        0, 0,  0,  0,  0,  0,  0,  0,  0, 0, 0,  0,  0, 0,
    },
    {
        -20, -10, -10, -5, -5, -10, -10, -20, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 0,   5,   0,  0,  0,   0,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 5,   5,   5,  5,  5,   0,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        0,   0,   5,   5,  5,  5,   0,   -5,  0, 0, 0, 0, 0, 0, 0, 0,
        -5,  0,   5,   5,  5,  5,   0,   -5,  0, 0, 0, 0, 0, 0, 0, 0,
        -10, 0,   5,   5,  5,  5,   0,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -10, 0,   0,   0,  0,  0,   0,   -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -20, -10, -10, -5, -5, -10, -10, -20, 0, 0, 0, 0, 0, 0, 0, 0,
    },
    {
        20,  30,  10,  0,   0,   10,  30,  20,  0, 0, 0, 0, 0, 0, 0, 0,
        20,  20,  0,   0,   0,   0,   20,  20,  0, 0, 0, 0, 0, 0, 0, 0,
        -10, -20, -20, -20, -20, -20, -20, -10, 0, 0, 0, 0, 0, 0, 0, 0,
        -20, -30, -30, -40, -40, -30, -30, -20, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, -40, -40, -50, -50, -40, -40, -30, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, -40, -40, -50, -50, -40, -40, -30, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, -40, -40, -50, -50, -40, -40, -30, 0, 0, 0, 0, 0, 0, 0, 0,
        -30, -40, -40, -50, -50, -40, -40, -30, 0, 0, 0, 0, 0, 0, 0, 0,
    }};

/* Very simple evaluation function for pieces */
int eval() {
    int centipawn = 0;

    for (Fast i = A1; i <= H8; i++) {
        if (board.colors[i] == WHITE) {
            centipawn += value[board.pieces[i]] + position[board.pieces[i]][i];
        } else if (board.colors[i] == BLACK) {
            int j = 112 + 2 * (i & 7) - i;
            centipawn -= value[board.pieces[i]] + position[board.pieces[i]][j];
        }
    }

    return (3 - 2 * board.player) * centipawn;
}